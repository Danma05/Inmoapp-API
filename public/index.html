<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>InmoApp - Encuentra tu hogar</title>
    
    <link rel="stylesheet" href="/css/variables.css">
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/home.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* CSS necesario para la retroalimentaci√≥n visual de carga (Asume que usas estas clases) */
        .doc-item.completed {
            border: 1px solid #10B981; /* Borde verde para indicar √©xito */
            background-color: #F0FDF4;
        }
        .doc-item.completed .doc-icon {
            color: #10B981;
        }
        .btn-uploaded {
            background-color: #10B981; /* Color verde */
            color: white;
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 0.9rem;
            pointer-events: none; /* Deshabilitar clics una vez subido */
        }
    </style>
</head>
<body>

    <header class="main-header">
        <div class="container nav-container">
            <a href="/" class="brand-logo">
                <div class="logo-box">IA</div>
                <span class="logo-text">InmoApp</span>
            </a>

            <div class="auth-buttons">
                <a href="#" class="nav-link-white open-login-btn">
                    <i class="fa-solid fa-arrow-right-to-bracket"></i> Iniciar sesi√≥n
                </a>
                <a href="#" class="btn-white open-register-btn">
                    <i class="fa-regular fa-user"></i> Registrarse
                </a>
            </div>
        </div>
    </header>

    <main>
        <section class="hero">
            <div class="hero-overlay">
                <div class="container hero-content">
                    <p class="hero-subtitle">Encuentra tu hogar ideal</p>
                    <h1>Busca entre 15.847 propiedades de agentes reconocidos</h1>
                    
                    <div class="search-tabs">
                        <button class="tab active">Residencial</button>
                        <button class="tab">Comercial</button>
                    </div>

                    <div class="search-bar-hero">
                        <input type="text" placeholder="Ciudad, barrio, direcci√≥n o n√∫mero MLS¬Æ">
                        <button class="btn-search-green">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </button>
                    </div>

                    <div class="hero-cta-box">
                        <p>¬øQuieres guardar tus b√∫squedas y propiedades favoritas?</p>
                        <div class="cta-buttons">
                            <button class="btn btn-outline-hero open-login-btn">
                                <i class="fa-solid fa-arrow-right-to-bracket"></i> Iniciar sesi√≥n
                            </button>
                            <button class="btn btn-red-hero open-register-btn">
                                <i class="fa-regular fa-user"></i> Registrarse gratis
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="featured-section">
            <div class="container">
                <div class="section-header-row">
                    <div class="header-titles">
                        <h2 class="section-title-left">Propiedades destacadas</h2>
                        <p class="section-subtitle">Descubre las mejores opciones disponibles</p>
                    </div>
                    <a href="#" class="btn-outline-red">Ver todas</a>
                </div>

                <div class="properties-grid-4">
                    <article class="property-card">
                        <div class="card-image">
                            <div class="login-overlay">
                                <i class="fa-regular fa-user"></i>
                                <span>Inicia sesi√≥n para ver m√°s detalles</span>
                            </div>
                            <img src="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?auto=format&fit=crop&w=400" alt="Propiedad">
                        </div>
                        <div class="card-content">
                            <div class="price">$450.000.000</div>
                            <h3>Apartamento Moderno</h3>
                            <p class="location"><i class="fa-solid fa-location-dot"></i> Providencia, Santiago</p>
                            <div class="card-features-text">2 hab ‚Ä¢ 2 ba√±os ‚Ä¢ 85 m¬≤</div>
                        </div>
                    </article>

                    <article class="property-card">
                        <div class="card-image">
                            <div class="login-overlay">
                                <i class="fa-regular fa-user"></i>
                                <span>Inicia sesi√≥n para ver m√°s detalles</span>
                            </div>
                            <img src="https://images.unsplash.com/photo-1600596542815-22b84f501263?auto=format&fit=crop&w=400" alt="Propiedad">
                        </div>
                        <div class="card-content">
                            <div class="price">$780.000.000</div>
                            <h3>Apartamento de Lujo</h3>
                            <p class="location"><i class="fa-solid fa-location-dot"></i> Las Condes, Santiago</p>
                            <div class="card-features-text">3 hab ‚Ä¢ 3 ba√±os ‚Ä¢ 140 m¬≤</div>
                        </div>
                    </article>

                    <article class="property-card">
                        <div class="card-image">
                            <div class="login-overlay">
                                <i class="fa-regular fa-user"></i>
                                <span>Inicia sesi√≥n para ver m√°s detalles</span>
                            </div>
                            <img src="https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?auto=format&fit=crop&w=400" alt="Propiedad">
                        </div>
                        <div class="card-content">
                            <div class="price">$320.000.000</div>
                            <h3>Casa Acogedora</h3>
                            <p class="location"><i class="fa-solid fa-location-dot"></i> √ëu√±oa, Santiago</p>
                            <div class="card-features-text">2 hab ‚Ä¢ 1 ba√±os ‚Ä¢ 75 m¬≤</div>
                        </div>
                    </article>

                    <article class="property-card">
                        <div class="card-image">
                            <div class="login-overlay">
                                <i class="fa-regular fa-user"></i>
                                <span>Inicia sesi√≥n para ver m√°s detalles</span>
                            </div>
                            <img src="https://images.unsplash.com/photo-1600585154340-be6161a56a0c?auto=format&fit=crop&w=400" alt="Propiedad">
                        </div>
                        <div class="card-content">
                            <div class="price">$950.000.000</div>
                            <h3>Oficina Corporativa</h3>
                            <p class="location"><i class="fa-solid fa-location-dot"></i> Centro, Santiago</p>
                            <div class="card-features-text">3 ba√±os ‚Ä¢ 200 m¬≤</div>
                        </div>
                    </article>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer-dark">
        <div class="container">
            <div class="footer-grid-dark">
                <div class="footer-col">
                    <h3 class="footer-heading">Contacto</h3>
                    <ul class="contact-list">
                        <li><i class="fa-solid fa-location-dot icon-red"></i> <span>Guadalajara de Buga</span></li>
                        <li><i class="fa-solid fa-phone icon-red"></i> <span>+57 322 669 8741</span></li>
                        <li><i class="fa-regular fa-envelope icon-red"></i> <span>info@inmoapp.com</span></li>
                    </ul>
                </div>
                <div class="footer-col center-col">
                    <h3 class="footer-heading">S√≠guenos</h3>
                    <div class="social-icons">
                        <a href="#" class="social-btn"><i class="fa-brands fa-facebook-f"></i></a>
                        <a href="#" class="social-btn"><i class="fa-brands fa-twitter"></i></a>
                        <a href="#" class="social-btn"><i class="fa-brands fa-instagram"></i></a>
                        <a href="#" class="social-btn"><i class="fa-brands fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="footer-col right-col">
                    <h3 class="footer-heading">Enlaces</h3>
                    <ul class="links-list">
                        <li><a href="#">Pol√≠tica de Privacidad</a></li>
                        <li><a href="#">T√©rminos y Condiciones</a></li>
                        <li><a href="#">Pol√≠ticas de Cookies</a></li>
                        <li><a href="#">Ayuda</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom-dark">
                <p>&copy; 2025 InmoApp. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <button class="floating-help-btn"><i class="fa-solid fa-question"></i></button>

    <div id="login-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-modal" class="close-btn">&times;</button>
            <div class="login-header">
                <h2>Iniciar Sesi√≥n</h2>
                <p>Accede a tu cuenta de InmoApp</p>
            </div>
            <form id="login-form-id" class="login-form">
                <div class="form-group">
                    <label>Correo electr√≥nico</label>
                    <div class="input-wrapper gray-style">
                        <i class="fa-regular fa-envelope left-icon"></i>
                        <input type="email" placeholder="tucorreo@ejemplo.com" required>
                        <i class="fa-solid fa-unlock-keyhole right-icon red-icon"></i>
                    </div>
                </div>
                <div class="form-group">
                    <label>Contrase√±a</label>
                    <div class="input-wrapper gray-style">
                        <i class="fa-solid fa-lock left-icon"></i>
                        <input type="password" placeholder="........" required>
                        <i class="fa-regular fa-eye right-icon red-icon"></i>
                    </div>
                    <div class="forgot-row">
                        <a href="#" class="forgot-link">¬øOlvidaste tu contrase√±a?</a>
                    </div>
                </div>
                <button type="submit" class="btn btn-full btn-red">Iniciar Sesi√≥n</button>
            </form>
            <div class="modal-divider">
                <span class="line"></span>
                <span class="circle-text">o</span>
                <span class="line"></span>
            </div>
            <div class="login-footer">
                <p>¬øNo tienes una cuenta? <a href="#" class="register-link">Reg√≠strate aqu√≠</a></p>
            </div>
        </div>
    </div>

    <div id="register-modal" class="modal-overlay hidden">
        <div class="modal-content modal-wide">
            <button id="close-register" class="close-btn">&times;</button>
            <h2 class="register-title">¬øQu√© deseas hacer en InmoApp?</h2>
            <div class="register-options">
                <div class="option-card">
                    <div class="option-image">
                        <img src="https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?auto=format&fit=crop&w=400" alt="Arrendar">
                    </div>
                    <div class="option-info">
                        <h3>Quiero Arrendar</h3>
                        <p>Encuentra el lugar perfecto para vivir. Explora propiedades disponibles.</p>
                        <button class="btn-blue-select btn-rent-select">Seleccionar</button>
                    </div>
                </div>

                <div class="option-card">
                    <div class="option-image">
                        <img src="https://images.unsplash.com/photo-1568605114967-8130f3a36994?auto=format&fit=crop&w=400" alt="Publicar">
                    </div>
                    <div class="option-info">
                        <h3>Quiero Publicar</h3>
                        <p>Ofrece tu propiedad a una amplia audiencia. Gestiona tus anuncios.</p>
                        <button class="btn-blue-select btn-publish-select">Seleccionar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="register-form-modal" class="modal-overlay hidden">
        <div class="modal-content modal-split-layout">
            <button id="close-register-form" class="close-btn-split">&times;</button>
            
            <div class="modal-left-panel">
                <div class="brand-overlay">
                    <div class="logo-box-lg">IA</div>
                    <h2>Alcanza tus sue√±os con nosotros</h2>
                    <p>Descubre oportunidades √∫nicas en el mercado inmobiliario y gestiona todo desde un solo lugar.</p>
                </div>
            </div>

            <div class="modal-right-panel">
                <div class="modal-top-nav-simple">
                    <button id="back-to-selection" class="btn-text-gray"><i class="fa-solid fa-arrow-left"></i> Volver</button>
                </div>

                <div class="login-header-left">
                    <h2>Crear Cuenta</h2>
                    <p>√önete a InmoApp gratis</p>
                </div>

                <form id="register-form" class="login-form">
                    <div class="form-row-split">
                        <div class="form-group">
                            <label>Nombre</label>
                            <div class="input-wrapper gray-style">
                                <input type="text" placeholder="Nombre" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Apellido</label>
                            <div class="input-wrapper gray-style">
                                <input type="text" placeholder="Apellido" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Correo electr√≥nico</label>
                        <div class="input-wrapper gray-style">
                            <input type="email" placeholder="tucorreo@ejemplo.com" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Contrase√±a</label>
                        <div class="input-wrapper gray-style">
                            <input type="password" placeholder="********" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Confirmar Contrase√±a</label>
                        <div class="input-wrapper gray-style">
                            <input type="password" placeholder="********" required>
                        </div>
                    </div>

                    <div class="terms-check">
                        <input type="checkbox" id="terms-split" required>
                        <label for="terms-split">Acepto los <a href="#">t√©rminos y condiciones</a></label>
                    </div>
                    
                    <input type="hidden" id="selected-role" value="inquilino">

                    <button type="submit" class="btn btn-full btn-red">Crear Cuenta</button>

                    <div class="modal-divider">
                        <span class="line"></span>
                        <span class="circle-text">o reg√≠strate con</span>
                        <span class="line"></span>
                    </div>

                    <div class="social-login-buttons">
                        <button type="button" class="btn-social google">
                            <i class="fa-brands fa-google"></i> Google
                        </button>
                        <button type="button" class="btn-social facebook">
                            <i class="fa-brands fa-facebook-f"></i> Facebook
                        </button>
                    </div>
                </form>
                
                <div class="login-footer">
                    <p>¬øYa tienes una cuenta? <a href="#" class="open-login-link">Inicia sesi√≥n</a></p>
                </div>
            </div>
        </div>
    </div>

    <div id="passport-modal" class="modal-overlay hidden">
        <div class="modal-content modal-wide">
            <button id="close-passport" class="close-btn">&times;</button>
            
            <div class="passport-header">
                <div class="brand-small">
                    <div class="logo-box-sm">IA</div> InmoApp
                </div>
                <h2>Pasaporte del Arrendatario</h2>
                <p>Completa tu perfil para aumentar las posibilidades de ser seleccionado.</p>
            </div>

            <div class="progress-section">
                <div class="progress-labels">
                    <span>Progreso</span>
                    <span id="progress-text">0%</span>
                </div>
                <div class="progress-track">
                    <div id="progress-bar-fill" class="progress-fill" style="width: 0%;"></div>
                </div>
            </div>

            <h3 class="docs-title">Documentos</h3>

            <div class="docs-list">
                <div class="doc-item">
                    <div class="doc-icon"><i class="fa-regular fa-address-card"></i></div>
                    <div class="doc-info">
                        <h4>Documento de Identidad</h4>
                        <p>C√©dula, DNI o Pasaporte</p>
                    </div>
                    <input type="file" class="file-input passport-file" id="file-id" hidden>
                    <button class="btn-upload" onclick="document.getElementById('file-id').click()">Subir</button>
                </div>

                <div class="doc-item">
                    <div class="doc-icon"><i class="fa-solid fa-file-invoice-dollar"></i></div>
                    <div class="doc-info">
                        <h4>Certificado de Solvencia</h4>
                        <p>Bancario o score crediticio</p>
                    </div>
                    <input type="file" class="file-input passport-file" id="file-solvency" hidden>
                    <button class="btn-upload" onclick="document.getElementById('file-solvency').click()">Subir</button>
                </div>

                <div class="doc-item">
                    <div class="doc-icon"><i class="fa-solid fa-money-check-dollar"></i></div>
                    <div class="doc-info">
                        <h4>Comprobante de Ingresos</h4>
                        <p>√öltimos 3 extractos o n√≥mina</p>
                    </div>
                    <input type="file" class="file-input passport-file" id="file-income" hidden>
                    <button class="btn-upload" onclick="document.getElementById('file-income').click()">Subir</button>
                </div>

                <div class="doc-item">
                    <div class="doc-icon"><i class="fa-regular fa-folder-open"></i></div>
                    <div class="doc-info">
                        <h4>Otros Documentos</h4>
                        <p>Referencias o codeudor</p>
                    </div>
                    <input type="file" class="file-input passport-file" id="file-others" hidden>
                    <button class="btn-upload" onclick="document.getElementById('file-others').click()">Subir</button>
                </div>
            </div>

            <div class="passport-footer">
                <button id="btn-finish-passport" class="btn-gray-disabled" disabled>Continuar</button>
            </div>
        </div>
    </div>

    <div id="publisher-modal" class="modal-overlay hidden">
        <div class="modal-content modal-wide">
            <button id="close-publisher" class="close-btn">&times;</button>
            
            <div class="passport-header">
                <div class="brand-small">
                    <div class="logo-box-sm">IA</div> InmoApp
                </div>
                <h2>Verificaci√≥n de Propietario</h2>
                <p>Para publicar, necesitamos validar la propiedad del inmueble.</p>
            </div>

            <div class="progress-section">
                <div class="progress-labels">
                    <span>Progreso</span>
                    <span id="pub-progress-text">0%</span>
                </div>
                <div class="progress-track">
                    <div id="pub-progress-bar-fill" class="progress-fill" style="width: 0%;"></div>
                </div>
            </div>

            <h3 class="docs-title">Documentaci√≥n Requerida</h3>

            <div class="docs-list">
                <div class="doc-item">
                    <div class="doc-icon"><i class="fa-regular fa-id-card"></i></div>
                    <div class="doc-info">
                        <h4>Documento de Identidad</h4>
                        <p>C√©dula del propietario titular</p>
                    </div>
                    <input type="file" class="file-input pub-file" id="pub-file-id" hidden>
                    <button class="btn-upload" onclick="document.getElementById('pub-file-id').click()">Subir</button>
                </div>

                <div class="doc-item">
                    <div class="doc-icon"><i class="fa-solid fa-certificate"></i></div>
                    <div class="doc-info">
                        <h4>Certificado de Libertad</h4>
                        <p>Vigencia menor a 30 d√≠as</p>
                    </div>
                    <input type="file" class="file-input pub-file" id="pub-file-cert" hidden>
                    <button class="btn-upload" onclick="document.getElementById('pub-file-cert').click()">Subir</button>
                </div>

                <div class="doc-item">
                    <div class="doc-icon"><i class="fa-solid fa-house-chimney"></i></div>
                    <div class="doc-info">
                        <h4>Impuesto Predial</h4>
                        <p>√öltimo comprobante de pago</p>
                    </div>
                    <input type="file" class="file-input pub-file" id="pub-file-tax" hidden>
                    <button class="btn-upload" onclick="document.getElementById('pub-file-tax').click()">Subir</button>
                </div>
            </div>

            <div class="passport-footer">
                <button id="btn-finish-publisher" class="btn btn-full btn-red" disabled>Finalizar Registro</button>
            </div>
        </div>
    </div>

    <script>
        // --- Referencias a los modales y botones ---
        const loginModal = document.getElementById('login-modal');
        const registerModal = document.getElementById('register-modal');
        const registerFormModal = document.getElementById('register-form-modal');
        const publisherModal = document.getElementById('publisher-modal');
        const passportModal = document.getElementById('passport-modal');
        
        // Botones de acci√≥n general
        const openLoginBtns = document.querySelectorAll('.open-login-btn');
        const openRegisterBtns = document.querySelectorAll('.open-register-btn');
        const closeLogin = document.getElementById('close-modal');
        const closeRegister = document.getElementById('close-register');
        const closeRegisterForm = document.getElementById('close-register-form');
        const closePublisher = document.getElementById('close-publisher');
        const closePassport = document.getElementById('close-passport');
        const backToSelection = document.getElementById('back-to-selection');

        // Botones de selecci√≥n de rol
        const rentSelectBtn = document.querySelector('.btn-rent-select');
        const publishSelectBtn = document.querySelector('.btn-publish-select');
        const selectedRoleInput = document.getElementById('selected-role');

        // Formularios y botones de finalizaci√≥n
        const loginForm = document.getElementById('login-form-id');
        const registerForm = document.getElementById('register-form');
        const btnFinishPublisher = document.getElementById('btn-finish-publisher'); // Propietario
        const btnFinishPassport = document.getElementById('btn-finish-passport');     // Arrendatario


        // --- Elementos de Progreso del PROPIETARIO ---
        const pubFileInputs = document.querySelectorAll('.pub-file'); // 3 documentos
        const pubProgressBarFill = document.getElementById('pub-progress-bar-fill');
        const pubProgressText = document.getElementById('pub-progress-text');

        // --- Elementos de Progreso del ARRENDATARIO ---
        const passportFileInputs = document.querySelectorAll('.passport-file'); // 4 documentos
        const passportProgressBarFill = document.getElementById('progress-bar-fill');
        const passportProgressText = document.getElementById('progress-text');
        

        // --- Funciones de control de modales ---
        function openModal(modal) {
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modal) {
            if (modal && !modal.classList.contains('hidden')) {
                modal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }
        }

        // --- L√ìGICA DE PROGRESO DE DOCUMENTOS PROPIETARIO ---
        function updatePublisherProgress() {
            let completedCount = 0;
            const totalDocs = pubFileInputs.length;

            pubFileInputs.forEach(input => {
                const docItem = input.closest('.doc-item');
                const uploadBtn = docItem.querySelector('button');
                
                if (input.files.length > 0) {
                    completedCount++;
                    
                    // Retroalimentaci√≥n visual
                    docItem.classList.add('completed');
                    if (uploadBtn) {
                         uploadBtn.textContent = 'Subido';
                         uploadBtn.classList.remove('btn-upload');
                         uploadBtn.classList.add('btn-uploaded');
                    }
                } else {
                    docItem.classList.remove('completed');
                    if (uploadBtn) {
                         uploadBtn.textContent = 'Subir';
                         uploadBtn.classList.add('btn-upload');
                         uploadBtn.classList.remove('btn-uploaded');
                    }
                }
            });

            const progressPercentage = (completedCount / totalDocs) * 100;
            
            if (pubProgressBarFill) {
                pubProgressBarFill.style.width = `${progressPercentage}%`;
            }
            if (pubProgressText) {
                pubProgressText.textContent = `${Math.round(progressPercentage)}%`;
            }

            // Habilitar bot√≥n de finalizaci√≥n solo cuando 100% completo
            if (progressPercentage === 100) {
                btnFinishPublisher.classList.remove('btn-gray-disabled');
                btnFinishPublisher.classList.remove('btn-red'); // Asegura que se usa la clase principal del bot√≥n si no es .btn-red
                btnFinishPublisher.classList.add('btn-red');
                btnFinishPublisher.disabled = false;
            } else {
                btnFinishPublisher.classList.add('btn-gray-disabled');
                btnFinishPublisher.classList.remove('btn-red');
                btnFinishPublisher.disabled = true;
            }
        }

        // --- L√ìGICA DE PROGRESO DE DOCUMENTOS ARRENDATARIO ---
        function updatePassportProgress() {
            let completedCount = 0;
            const totalDocs = passportFileInputs.length;

            passportFileInputs.forEach(input => {
                const docItem = input.closest('.doc-item');
                const uploadBtn = docItem.querySelector('button');
                
                if (input.files.length > 0) {
                    completedCount++;
                    // Retroalimentaci√≥n visual (misma l√≥gica que propietario)
                    docItem.classList.add('completed');
                    if (uploadBtn) {
                         uploadBtn.textContent = 'Subido';
                         uploadBtn.classList.remove('btn-upload');
                         uploadBtn.classList.add('btn-uploaded');
                    }
                } else {
                    docItem.classList.remove('completed');
                    if (uploadBtn) {
                         uploadBtn.textContent = 'Subir';
                         uploadBtn.classList.add('btn-upload');
                         uploadBtn.classList.remove('btn-uploaded');
                    }
                }
            });

            const progressPercentage = (completedCount / totalDocs) * 100;
            
            if (passportProgressBarFill) {
                passportProgressBarFill.style.width = `${progressPercentage}%`;
            }
            if (passportProgressText) {
                passportProgressText.textContent = `${Math.round(progressPercentage)}%`;
            }

            // Habilitar bot√≥n de Continuar al alcanzar el 50% (ejemplo)
            if (progressPercentage >= 50) {
                btnFinishPassport.classList.remove('btn-gray-disabled');
                btnFinishPassport.classList.add('btn-red');
                btnFinishPassport.disabled = false;
            } else {
                btnFinishPassport.classList.add('btn-gray-disabled');
                btnFinishPassport.classList.remove('btn-red');
                btnFinishPassport.disabled = true;
            }
        }


        // --- MANEJADORES DE EVENTOS GLOBALES ---

        // Abrir/Cerrar modales
        [...openLoginBtns, document.querySelector('.open-login-link')].forEach(btn => btn.addEventListener('click', (e) => {
            e.preventDefault();
            closeModal(registerFormModal);
            closeModal(registerModal);
            closeModal(publisherModal);
            closeModal(passportModal);
            openModal(loginModal);
        }));
        closeLogin.addEventListener('click', () => closeModal(loginModal));
        
        openRegisterBtns.forEach(btn => btn.addEventListener('click', (e) => {
            e.preventDefault();
            closeModal(loginModal);
            openModal(registerModal);
        }));
        closeRegister.addEventListener('click', () => closeModal(registerModal));

        backToSelection.addEventListener('click', () => {
            closeModal(registerFormModal);
            openModal(registerModal);
        });
        closeRegisterForm.addEventListener('click', () => closeModal(registerFormModal));
        closePublisher.addEventListener('click', () => closeModal(publisherModal));
        closePassport.addEventListener('click', () => closeModal(passportModal));

        document.querySelector('.register-link').addEventListener('click', (e) => {
            e.preventDefault();
            closeModal(loginModal);
            openModal(registerModal);
        });


        // --- MANEJO DE INICIO DE SESI√ìN (LOGIN) ---
        if (loginForm) {
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                // Simulaci√≥n: asume que el inicio de sesi√≥n fue exitoso

                // 1. Cerrar el modal
                closeModal(loginModal); 
                
                // 2. Redireccionar al dashboard (general)
                // Nota: En una app real, aqu√≠ se verificar√≠a el rol (arrendatario/propietario)
                // Para simplificar, redirigimos al general /dashboard
                window.location.href = '/dashboard'; 
            });
        }


        // --- ASIGNACI√ìN DE ROL Y FLUJO DE REGISTRO ---

        rentSelectBtn.addEventListener('click', () => {
            selectedRoleInput.value = 'inquilino';
            closeModal(registerModal);
            openModal(registerFormModal);
        });

        publishSelectBtn.addEventListener('click', () => {
            selectedRoleInput.value = 'propietario';
            closeModal(registerModal);
            openModal(registerFormModal);
        });


        // MANEJO DE ENV√çO DE FORMULARIO DE REGISTRO (SIMULACI√ìN)
        registerForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const role = selectedRoleInput.value;
            
            closeModal(registerFormModal);

            if (role === 'propietario') {
                openModal(publisherModal); 
                updatePublisherProgress(); // Inicializa el progreso
            } else {
                openModal(passportModal);
                updatePassportProgress(); // Inicializa el progreso
            }
        });

        // üö® EVENT LISTENERS PARA LA CARGA DE DOCUMENTOS üö®
        
        // Propietario
        pubFileInputs.forEach(input => {
            input.addEventListener('change', updatePublisherProgress);
        });

        // Arrendatario
        passportFileInputs.forEach(input => {
            input.addEventListener('change', updatePassportProgress);
        });


        // --- REDIRECCIONES FINALES ---

        // Redirecci√≥n Propietario
        if (btnFinishPublisher) {
            btnFinishPublisher.addEventListener('click', () => {
                closeModal(publisherModal);
                window.location.href = '/dashboard-propietario'; 
            });
        }
        
        // Redirecci√≥n Arrendatario
        if (btnFinishPassport) {
            btnFinishPassport.addEventListener('click', () => {
                closeModal(passportModal);
                window.location.href = '/dashboard';
            });
        }


        // Otras interacciones de modal (cerrar al hacer clic en overlay)
        [loginModal, registerModal, registerFormModal, passportModal, publisherModal].forEach(modal => {
            if (modal) {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        closeModal(modal);
                    }
                });
            }
        });
    </script>
</body>
</html>